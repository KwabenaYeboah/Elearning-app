{% extends "_base.html" %}
{% load course %}
{% block title %}
  Module {{ module.order}}: {{ module.title }}
{% endblock %}

{% block content %}
  {% with course=module.course %}
    <h1>Course "{{ course.title }}"</h1>
    <div class="contents">
      <h3>Modules</h3>
      <ul id="modules">
        {% for mod in course.modules.all %}
          <li data-id="{{ mod.id }}" {% if mod == module %}
           class="selected"{% endif %}>
            <a href="{% url 'module_content_list' mod.id %}">
              <span>
                Module <span class="order">{{ mod.order}}</span>
              </span>
              <br>
              {{ mod.title }}
            </a>
          </li>
        {% empty %}
          <li>No modules yet.</li>
        {% endfor %}
      </ul>
      <p><a href="{% url 'course_module_update' course.id %}">
      Edit modules</a></p>
    </div>
    <div class="module">
      <h2>Module {{ module.order }}: {{ module.title }}</h2>
      <h3>Module contents:</h3>

      <div id="module-contents">
        {% for item in module.contents.all %}
          <div data-id="{{ item.id }}">
            {% with content=item.content %}
              <p>{{ content }} ({{ content|model_name }})</p>
              <a href="{% url 'module_content_update' module.id content|model_name content.id %}">Edit</a>
              <form action="{% url 'module_content_delete' item.id %}" method="post">
                <input type="submit" value="Delete">
                {% csrf_token %}
              </form>
            {% endwith %}
          </div>
        {% empty %}
          <p>This module has no contents yet.</p>
        {% endfor %}
      </div>
      <h3>Add new content:</h3>
      <ul class="content-types">
        <li><a href="{% url 'module_content_create' module.id 'text' %}">Text</a></li>
        <li><a href="{% url 'module_content_create' module.id 'image' %}">Image</a></li>
        <li><a href="{% url 'module_content_create' module.id  'video' %}">Video</a></li>
        <li><a href="{% url 'module_content_create' module.id 'file' %}">File</a></li>
      </ul>
    </div>
  {% endwith %}
{% endblock %}